# QSDT哥白尼计划单元测试

## 概述

本目录包含QSDT哥白尼计划的完整单元测试套件，确保理论计算的准确性和数值稳定性。

## 测试结构

```
tests/
├── __init__.py              # 测试包初始化
├── test_config.py           # 配置文件测试
├── test_rg.py              # 重正化群测试
├── test_models.py          # 模型计算测试
├── test_strict_formulas.py # 严格公式测试
├── test_pipeline.py        # 管道测试
├── run_tests.py            # 测试运行器
├── test_config_example.yaml # 测试配置文件
├── test_data.yaml          # 测试数据
└── README.md               # 本文件
```

## 测试覆盖范围

### 1. 配置文件测试 (`test_config.py`)
- 配置文件加载和验证
- 参数类型和值检查
- 理论常数一致性验证
- 单位转换因子验证

### 2. 重正化群测试 (`test_rg.py`)
- RG状态初始化
- Beta函数计算
- 参数演化测试
- 数值稳定性验证
- 理论一致性检查

### 3. 模型计算测试 (`test_models.py`)
- 希格斯质量计算
- 轻子质量谱计算
- 质子-中子质量差计算
- 单位转换测试
- 归一化方法验证

### 4. 严格公式测试 (`test_strict_formulas.py`)
- 所有物理量计算函数
- 理论预测值验证
- 实验值比较
- 数值精度检查
- 边界情况处理

### 5. 管道测试 (`test_pipeline.py`)
- 完整计算流程
- 输出格式验证
- 性能测试
- 错误处理测试
- 物理一致性检查

## 运行测试

### 运行所有测试
```bash
cd scripts/copernicus
python tests/run_tests.py
```

### 运行特定测试
```bash
# 运行配置文件测试
python tests/run_tests.py --test config

# 运行重正化群测试
python tests/run_tests.py --test rg

# 运行模型测试
python tests/run_tests.py --test models

# 运行严格公式测试
python tests/run_tests.py --test formulas

# 运行管道测试
python tests/run_tests.py --test pipeline
```

### 详细输出
```bash
python tests/run_tests.py --verbose
```

### 遇到第一个失败就停止
```bash
python tests/run_tests.py --failfast
```

## 测试数据

### 标准测试参数
- **246 GeV**: J=8.97e8 J, E=2.69e9 J, g=0.313
- **85 GeV**: J=7.85e8 J, E=2.35e9 J, g=0.285
- **1 GeV**: J=5.23e8 J, E=1.57e9 J, g=0.156

### 理论预测值
- 希格斯质量: 125.10 GeV
- 电子质量: 0.511 MeV
- μ子质量: 105.66 MeV
- τ子质量: 1776.86 MeV
- 质子-中子质量差: 1.293 MeV
- 温伯格角: sin²θ_W = 0.231

### 精度要求
- 希格斯质量: 相对误差 < 1%
- 轻子质量: 相对误差 < 0.1%
- 质子-中子质量差: 相对误差 < 5%
- 温伯格角: 相对误差 < 1%
- 高精度量: 相对误差 < 0.0001%

## 理论文档引用

所有测试都基于以下理论文档：
- **附录7**: 哥白尼计划 - RG演化方程
- **附录8**: 哥白尼计划v6.0 - 轻子质量谱预测
- **附录10**: 希格斯质量理论推导
- **附录13**: 哥白尼计划扩展纲领
- **附录15**: 强CP问题理论解释
- **附录21**: 温伯格角验证
- **附录24**: QSDT终极参数附录
- **附录26**: 单位转换与物理常数

## 注意事项

### 数值稳定性
- 所有计算必须通过数值稳定性测试
- 极端参数值不应导致计算失败
- 单位转换必须保持精度

### 理论一致性
- 所有参数必须基于理论推导
- 计算必须符合QSDT理论框架
- 结果必须与理论预测一致

### 实验验证
- 理论预测必须与实验值比较
- 相对误差必须在可接受范围内
- 物理量必须符合物理规律

## 故障排除

### 常见问题

1. **导入错误**
   - 确保在正确的目录下运行测试
   - 检查Python路径设置

2. **配置错误**
   - 确保配置文件格式正确
   - 检查YAML语法

3. **数值错误**
   - 检查单位转换是否正确
   - 验证参数值是否合理

4. **理论不一致**
   - 检查理论文档引用
   - 验证参数来源

### 调试技巧

1. **详细输出**
   ```bash
   python tests/run_tests.py --verbose
   ```

2. **特定测试**
   ```bash
   python tests/run_tests.py --test formulas --verbose
   ```

3. **失败停止**
   ```bash
   python tests/run_tests.py --failfast
   ```

## 贡献指南

### 添加新测试
1. 在相应的测试文件中添加测试方法
2. 确保测试覆盖所有边界情况
3. 添加适当的文档说明
4. 验证测试通过

### 修改现有测试
1. 确保修改不会破坏现有功能
2. 更新相关文档
3. 运行完整测试套件
4. 验证所有测试通过

### 测试标准
- 每个测试方法必须独立
- 测试必须可重复
- 测试必须快速执行
- 测试必须清晰易懂

---

**本测试套件确保QSDT哥白尼计划的理论计算准确性和数值稳定性。**
